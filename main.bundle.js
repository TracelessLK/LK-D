module.exports=function(e){function n(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,n),s.l=!0,s.exports}var t={};return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(o,s,function(n){return e[n]}.bind(null,s));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=2)}([function(e){e.exports=require("electron")},function(e,n,t){e.exports=function(e){function n(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return o.colors[Math.abs(n)%o.colors.length]}function o(e){function t(...e){if(!t.enabled)return;const n=t,s=+new Date,r=s-(i||s);n.diff=r,n.prev=i,n.curr=s,i=s,e[0]=o.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(t,s)=>{if("%%"===t)return t;a++;const r=o.formatters[s];if("function"==typeof r){const o=e[a];t=r.call(n,o),e.splice(a,1),a--}return t}),o.formatArgs.call(n,e),(n.log||o.log).apply(n,e)}let i;return t.namespace=e,t.enabled=o.enabled(e),t.useColors=o.useColors(),t.color=n(e),t.destroy=s,t.extend=r,"function"==typeof o.init&&o.init(t),o.instances.push(t),t}function s(){const e=o.instances.indexOf(this);return-1!==e&&(o.instances.splice(e,1),!0)}function r(e,n){return o(this.namespace+(void 0===n?":":n)+e)}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return o.debug=o,o.default=o,o.coerce=function(e){return e instanceof Error?e.stack||e.message:e},o.disable=function(){const e=[...o.names.map(i),...o.skips.map(i).map(e=>"-"+e)].join(",");return o.enable(""),e},o.enable=function(e){let n;o.save(e),o.names=[],o.skips=[];const t=("string"==typeof e?e:"").split(/[\s,]+/),s=t.length;for(n=0;n<s;n++)t[n]&&("-"===(e=t[n].replace(/\*/g,".*?"))[0]?o.skips.push(new RegExp("^"+e.substr(1)+"$")):o.names.push(new RegExp("^"+e+"$")));for(n=0;n<o.instances.length;n++){const e=o.instances[n];e.enabled=o.enabled(e.namespace)}},o.enabled=function(e){if("*"===e[e.length-1])return!0;let n,t;for(n=0,t=o.skips.length;n<t;n++)if(o.skips[n].test(e))return!1;for(n=0,t=o.names.length;n<t;n++)if(o.names[n].test(e))return!0;return!1},o.humanize=t(10),Object.keys(e).forEach(n=>{o[n]=e[n]}),o.instances=[],o.names=[],o.skips=[],o.formatters={},o.selectColor=n,o.enable(o.load()),o}},function(e,n,t){function o(){(F=new u({width:1024,height:768})).loadURL(f.format({pathname:p.join(__dirname,y+"/index/loading.html"),protocol:"file:",slashes:!0})),global.mainWindow=F,global.appVersion=v.version,b.register("Control+Alt+I",()=>{F.webContents.openDevTools()}),i(function(e){e?F.loadURL(f.format({pathname:p.join(__dirname,y+"/index/update.html"),protocol:"file:",slashes:!0})):F.loadURL(f.format({pathname:p.join(__dirname,y+"/index/index.html"),protocol:"file:",slashes:!0}))}),F.on("closed",function(){F=null}),F.on("focus",function(){F.webContents.send("mainWindow-focus")})}function s(){_||(_=new u({frame:!1,modal:!0,transparent:!0,show:!1,width:0,height:0,alwaysOnTop:!0})).on("closed",function(){_=null}),_.loadURL(f.format({pathname:p.join(__dirname,y+"/recent/showCapture.html"),protocol:"file:",slashes:!0}))}function r(e,n){for(var t=e.split("."),o=n.split("."),s=0;3>s;s++){var r=parseInt(t[s]),i=parseInt(o[s]);if(r>i)return 1;if(r!=i)return-1}return 0}function i(e){let n=h.request("https://raw.githubusercontent.com/tracelessman/LK-D/publish/upgrade.json");n.on("response",n=>{let t="";200==n.statusCode?(n.on("data",e=>{t+=e}),n.on("end",()=>{let n=JSON.parse(t);if(1==r(S=n.version,v.version)){j=!0,e(!0);let t=n.changeList;k=["package.json"];for(var o,s=0;s<t.length;s++)if(1==r((o=t[s]).version,v.version)){o.files.forEach(function(e){-1==k.indexOf(e)&&k.push(e)})}}else e(!1)})):(e(!1),console.info("check update response.statusCode:"+n.statusCode))}),n.on("error",function(n){e(!1),console.info(n.toString())}),n.end()}function a(e){function n(e,n){E.set(e,n),global.upgradeMessage=function(){var e="";return E.forEach(function(n,t){e+=t+"---------------------"+n+"<br>"}),e}(),F.webContents.executeJavaScript("update()")}function t(e){if(m.existsSync(e)){m.readdirSync(e).forEach(function(n){var o=p.join(e,n);m.statSync(o).isDirectory()&&!o.endsWith(".asar")?t(o):m.unlinkSync(o)});try{m.rmdirSync(e)}catch(n){m.readdirSync(e).forEach(function(e){g.showMessageBox({message:e})})}}}var o="https://raw.githubusercontent.com/tracelessman/LK-D/publish/",s=o.length,r=0,i=0,a=p.join(__dirname,"_tmp");t(a),F.webContents.session.on("will-download",(o,c)=>{var l=c.getURL().substring(s);c.setSavePath(p.join(a,l)),c.on("updated",(e,t)=>{"interrupted"===t?(n(l,"interrupted"),c.canResume()?c.resume():n(l,"interrupted and can't resume")):"progressing"===t&&(c.isPaused()?n(l,"paused"):n(l,Math.round(c.getReceivedBytes()/c.getTotalBytes()*100)+"%"))}),c.once("done",(o,s)=>{if(r++,"completed"===s?(i++,n(l,"100%")):n(l,`Download failed: ${s}`),r==e.length){if(i==r){var c=__dirname;(function(){const e=1===parseInt(process.env.ELECTRON_IS_DEV,10);return"ELECTRON_IS_DEV"in process.env?e:process.defaultApp||/node_modules[\\\/]electron[\\\/]/.test(process.execPath)})()&&(c=p.join(__dirname,"_tmp2"),!m.existsSync(c)&&m.mkdirSync(c)),function e(n,t){m.readdirSync(n).forEach(function(o){var s=p.join(n,o),r=p.join(t,o);m.statSync(s).isDirectory()?s.endsWith(".asar")?w.writeFileSync(r,w.readFileSync(s)):(!m.existsSync(r)&&m.mkdirSync(r),e(s,r)):m.renameSync(s,r)})}(a,c),t(a)}F.webContents.executeJavaScript("complete()")}})}),e.forEach(function(e){n(e,"downloading"),F.webContents.downloadURL(o+e)}),0==e.length&&F.webContents.executeJavaScript("complete()")}const c=t(0),l=c.app,u=c.BrowserWindow,d=t(0).ipcMain,p=t(3),f=t(4),m=t(5),C=t(0).nativeImage,h=c.net,g=c.dialog,w=t(6),b=c.globalShortcut,y="",v=t(7);t(8)("debug");let F,x,_;if(l.on("ready",o),l.on("ready",()=>{b.register("Control+Alt+A",()=>{_||s()})}),l.on("will-quit",()=>{b.unregisterAll()}),l.on("window-all-closed",function(){"darwin"!==process.platform&&l.quit()}),l.on("activate",function(){null===F&&o()}),d.on("openFileDialog",function(e){var n=g.showOpenDialog({properties:["openFile"]});n&&0<n.length&&m.readFile(n[0],function(t,o){if(o){var s=o.toJSON().data,r=n[0].split(/[\\|\/]/gi);e.sender.send("openFileDialog-response",{data:s,name:r[r.length-1]})}})}),d.on("openImageBrowser",function(e,n){global.imageHtml=n.html,x||(x=new u).on("closed",function(){x=null}),x.loadURL(f.format({pathname:p.join(__dirname,y+"/recent/showImage.html"),protocol:"file:",slashes:!0})),x.setSize(n.width+100,n.height+100),x.center(),x.setAlwaysOnTop(!1),x.show()}),d.on("openCaptureBrowser",function(){s()}),d.on("showCaptureBrowser",function(){_.setFullScreen(!0),_.show()}),d.on("closeCaptureBrowser",function(e,n){_&&(_.minimize(),_.close(),_=null,n&&F.webContents.send("capture-complete"))}),l.dock){let e=p.join(__dirname,"/images/traceless.png");var O=C.createFromPath(e);l.dock.setIcon(O)}d.on("messageReceive",function(e,n){l.dock&&n.total&&l.dock.setBadge(n.total+"")}),d.on("messageRead",function(e,n){l.dock&&(n.total?l.dock.setBadge(n.total+""):l.dock.setBadge(""))});let S,j=!1,k=[];d.on("remoteVersion-request",function(e){i(function(){e.sender.send("remoteVersion-response",S||v.version)})}),d.on("upgrade-request",function(e,n){i(function(e){e?F.loadURL(f.format({pathname:p.join(__dirname,y+"/index/update.html"),protocol:"file:",slashes:!0})):!1!==n.toIndexIFNot&&F.loadURL(f.format({pathname:p.join(__dirname,y+"/index/index.html"),protocol:"file:",slashes:!0}))})});let E=new Map;d.on("start-download",function(){a(k)}),d.on("restart",function(){l.relaunch(),l.exit(0)})},function(e){e.exports=require("path")},function(e){e.exports=require("url")},function(e){e.exports=require("fs")},function(e){e.exports=require("original-fs")},function(e){e.exports={name:"LK-D",version:"0.0.16",main:"./main.bundle.js",scripts:{start:"cross-env NODE_ENV=development electron ./main.js",build:"node build.js",publish:"node build.js && electron .",asars:"node bin/asars",postinstall:"node bin/postinstall","install:sqlite3":"node bin/installSqlite3",updateC:"rm -rf node_modules/@lk && npm i",updateC2:"npm i github:tracelessman/LK-C && node bin/postInstall"},devDependencies:{"@ys/eslint-config-strict":"github:spirit1453/codebase#strict_eslint",asar:"^0.14.2","babel-loader":"^7.1.3","babili-webpack-plugin":"^0.1.2",chalk:"^2.4.1","cross-env":"^5.2.0",del:"^3.0.0",electron:"3.0.7",webpack:"^4.0.1"},dependencies:{"@lk/LK-C":"github:tracelessman/LK-C","@ys/collection":"github:spirit1453/node_collection#publish","crypto-js":"^3.1.9-1",debug:"^4.1.0",lodash:"4.17.11","qr-image":"^3.2.0","react-native-rsa":"0.0.3",sqlite3:"^4.0.4",uuid:"^3.2.1",ws:"^4.0.0"}}},function(e,n,t){e.exports="undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?t(9):t(11)},function(e,n,t){n.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},n.formatArgs=function(n){if(n[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+n[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const t="color: "+this.color;n.splice(1,0,t,"color: inherit");let o=0,s=0;n[0].replace(/%[a-zA-Z%]/g,e=>{"%%"===e||(o++,"%c"===e&&(s=o))}),n.splice(s,0,t)},n.save=function(e){try{e?n.storage.setItem("debug",e):n.storage.removeItem("debug")}catch(e){}},n.load=function(){let e;try{e=n.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},n.useColors=function(){return"undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},n.storage=function(){try{return localStorage}catch(e){}}(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=t(1)(n);const{formatters:o}=e.exports;o.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},function(e){function n(e){if(!(100<(e+="").length)){var n=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(n){var t=parseFloat(n[1]),o=(n[2]||"ms").toLowerCase();return"years"===o||"year"===o||"yrs"===o||"yr"===o||"y"===o?t*d:"weeks"===o||"week"===o||"w"===o?t*u:"days"===o||"day"===o||"d"===o?t*l:"hours"===o||"hour"===o||"hrs"===o||"hr"===o||"h"===o?t*c:"minutes"===o||"minute"===o||"mins"===o||"min"===o||"m"===o?t*a:"seconds"===o||"second"===o||"secs"===o||"sec"===o||"s"===o?t*i:"milliseconds"===o||"millisecond"===o||"msecs"===o||"msec"===o||"ms"===o?t:void 0}}}function t(e){var n=r(e);return n>=l?o(e,n,l,"day"):n>=c?o(e,n,c,"hour"):n>=a?o(e,n,a,"minute"):n>=i?o(e,n,i,"second"):e+" ms"}function o(e,n,t,o){return s(e/t)+" "+o+(n>=1.5*t?"s":"")}var s=Math.round,r=Math.abs,i=1e3,a=60*i,c=60*a,l=24*c,u=7*l,d=365.25*l;e.exports=function(e,o){o=o||{};var u=typeof e;if("string"==u&&0<e.length)return n(e);if("number"==u&&!1===isNaN(e))return o.long?t(e):function(e){var n=r(e);return n>=l?s(e/l)+"d":n>=c?s(e/c)+"h":n>=a?s(e/a)+"m":n>=i?s(e/i)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,n,t){function o(){return n.inspectOpts.hideDate?"":(new Date).toISOString()+" "}const s=t(12),r=t(13);n.init=function(e){e.inspectOpts={};const t=Object.keys(n.inspectOpts);for(let o=0;o<t.length;o++)e.inspectOpts[t[o]]=n.inspectOpts[t[o]]},n.log=function(...e){return process.stderr.write(r.format(...e)+"\n")},n.formatArgs=function(n){const{namespace:t,useColors:s}=this;if(s){const o=this.color,s="[3"+(8>o?o:"8;5;"+o),r=`  ${s};1m${t} [0m`;n[0]=r+n[0].split("\n").join("\n"+r),n.push(s+"m+"+e.exports.humanize(this.diff)+"[0m")}else n[0]=o()+t+" "+n[0]},n.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},n.load=function(){return process.env.DEBUG},n.useColors=function(){return"colors"in n.inspectOpts?!!n.inspectOpts.colors:s.isatty(process.stderr.fd)},n.colors=[6,2,3,4,5,1];try{const o=t(14);o&&2<=(o.stderr||o).level&&(n.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}n.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,n)=>{const t=n.substring(6).toLowerCase().replace(/_([a-z])/g,(e,n)=>n.toUpperCase());let o=process.env[n];return o=!!/^(yes|on|true|enabled)$/i.test(o)||!/^(no|off|false|disabled)$/i.test(o)&&("null"===o?null:+o),e[t]=o,e},{}),e.exports=t(1)(n);const{formatters:i}=e.exports;i.o=function(e){return this.inspectOpts.colors=this.useColors,r.inspect(e,this.inspectOpts).replace(/\s*\n\s*/g," ")},i.O=function(e){return this.inspectOpts.colors=this.useColors,r.inspect(e,this.inspectOpts)}},function(e){e.exports=require("tty")},function(e){e.exports=require("util")},function(e){"use strict";var n=process.argv,t=n.indexOf("--"),o=function(e){e="--"+e;var o=n.indexOf(e);return-1!==o&&(!(-1!==t)||o<t)};e.exports=!!("FORCE_COLOR"in process.env)||!(o("no-color")||o("no-colors")||o("color=false"))&&(o("color")||o("colors")||o("color=true")||o("color=always")||!(process.stdout&&!process.stdout.isTTY)&&(!("win32"!==process.platform)||!!("COLORTERM"in process.env)||"dumb"!==process.env.TERM&&!!/^screen|^xterm|^vt100|color|ansi|cygwin|linux/i.test(process.env.TERM)))}]);